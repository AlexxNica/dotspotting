{assign var="page_title" value="Upload a file"}
{include file="inc_head.txt"}

{if $error.uploads_disabled}
<p class="error">Uploads are currently disabled.</p>
{else}

{if $error|@count}

<p class="error">
{if $error.badcrumb}
CRUMB.
{else}
INVISIBLE ERROR CAT HISSES AT YOU.
{/if}
</p>
{/if}

{if $upload_complete}

{if $rsp.bucket.label}
<p>Your dots ({$rsp.dots_processed|escape} of them) have been uploaded in to a bucket labeled <a href="{$rsp.bucket|@urls_url_for_bucket}">{$rsp.bucket.label|escape}</a>.</p>
{else}
<p>Your dots ({$rsp.dots_processed|escape} of them) have been uploaded in to a new <a href="{$rsp.bucket|@urls_url_for_bucket}">bucket</a>.</p>
{/if}

{if $rsp.dots_received != $rsp.dots_processed}

<p><strong>But!</strong> Not all of the dots you uploaded could be processed. Of the {$rsp.dots_received|escape} dots you uploaded only {$rsp.dots_processed|escape} were able to be imported in to dotspotting. The following errors were reported:</p> 

<ul>
{foreach from=$rsp.errors item="row"}
<li>Record number <strong>{$row.record|escape}</strong>: <q>{$row.error|escape}</q></li>
{/foreach}
</ul>

{/if}

<p>Would you like to upload another set of dots?</p>

{/if}

<form method="POST" enctype="multipart/form-data" accept-encoding="UTF-8">
	{$crumb_key|crumb_input}

	<input type="file" size="40" name="upload" />
	<br />
	<label for="upload">Choose a file to upload</label>
	<br /><br />

	<input type="text" size="40" name="label" />
	<br />
	<label for="label">Give your upload a name (optional)</label>
	<br /><br />

	<input type="SUBMIT" value="UPLOAD YOUR DOTS!" />
</form>

{/if}

{include file="inc_foot.txt"}
