{assign var="page_title" value="Upload some dots!"}
{include file="inc_head.txt"}

{if $error.uploads_disabled}
<p class="error">Uploads are currently disabled.</p>
{else}

{if $error|@count}

{if $error.invalid_mimetype}
<p class="error">Your upload failed because your upload was an invalid file type or Dotspotting wasn't smart enough to recognize it.</p>
{elseif $error.parse_fail}
<p class="error">Your upload failed because Dotspotting was not able to parse your file. Sad face...</p>
{elseif $error.process_fail}
<p class="error">Your upload failed with the following errors:</p>
<ul>
{foreach from=$upload_errors item="row"}
	<li><q>{$row.error|escape}</q> at record #{$row.record|escape}</li>
{/foreach}
</ul>
{else}
<p class="error">ARGH!!! INVISIBLE ERROR CAT HISSES AT YOU.</p>
{/if}
{/if}

{if $upload_complete}

{if $rsp.bucket.label}
<p>Your dots ({$rsp.dots_processed|escape} of them) have been uploaded in to a bucket labeled <a href="{$rsp.bucket|@urls_url_for_bucket}">{$rsp.bucket.label|escape}</a>.</p>
{else}
<p>Your dots ({$rsp.dots_processed|escape} of them) have been uploaded in to a new <a href="{$rsp.bucket|@urls_url_for_bucket}">bucket</a>.</p>
{/if}

{if $rsp.dots_received != $rsp.dots_processed}

<p><strong>But!</strong> Not all of the dots you uploaded could be processed. Of the {$rsp.dots_received|escape} dots you uploaded only {$rsp.dots_processed|escape} were able to be imported in to dotspotting. The following errors were reported:</p> 

<ul>
{foreach from=$rsp.errors item="row"}
<li>Record number <strong>{$row.record|escape}</strong>: <q>{$row.error|escape}</q></li>
{/foreach}
</ul>

{/if}

{/if}

{include file="inc_upload_file.txt"}

{/if}

{include file="inc_foot.txt"}
